# TimeNest 课程表软件新功能使用说明

## 概述

本文档介绍了TimeNest课程表软件新增的功能和服务，包括用户管理、通知管理、统计分析、数据导入导出、备份恢复、系统配置、课程冲突检测、自动提醒和数据同步等功能。

## 新增服务列表

### 1. 用户服务 (UserService)
提供密码保护功能，允许用户设置系统密码来保护配置。

**主要功能：**
- 设置系统密码
- 禁用密码保护
- 验证密码
- 检查密码保护状态

**使用示例：**
```python
from services.service_factory import ServiceFactory

user_service = ServiceFactory.get_user_service()

# 设置密码
user_service.set_password("my_password")

# 验证密码
is_valid = user_service.verify_password("my_password")

# 禁用密码保护
user_service.disable_password()
```

### 2. 通知服务 (NotificationService)
提供通知管理功能，支持创建、更新、删除和查询通知。

**主要功能：**
- 创建通知
- 更新通知
- 删除通知
- 查询通知
- 标记通知为已读

**使用示例：**
```python
from services.service_factory import ServiceFactory

notification_service = ServiceFactory.get_notification_service()

# 创建通知
notification = notification_service.create_notification(
    title="系统通知",
    content="这是一条系统通知",
    priority="normal",
    category="system"
)

# 标记为已读
notification_service.mark_as_read(notification.id)
```

### 3. 统计服务 (StatisticsService)
提供课程、时间和教师的统计分析功能。

**主要功能：**
- 课程统计
- 时间统计
- 教师统计
- 获取所有统计数据

**使用示例：**
```python
from services.service_factory import ServiceFactory

statistics_service = ServiceFactory.get_statistics_service()

# 获取课程统计
course_stats = statistics_service.get_course_statistics()

# 获取所有统计数据
all_stats = statistics_service.get_all_statistics()
```

### 4. 数据服务 (DataService)
提供数据导入导出功能，支持JSON、CSV和Excel格式。

**主要功能：**
- 导出数据
- 导入数据

**使用示例：**
```python
from services.service_factory import ServiceFactory
from models.data_export import DataExportConfig, ExportFormat

data_service = ServiceFactory.get_data_service()

# 配置导出
config = DataExportConfig(
    format=ExportFormat.JSON,
    include_courses=True,
    include_schedules=True
)

# 导出数据
export_path = data_service.export_data(config, "./exports/my_data.json")
```

### 5. 备份服务 (BackupService)
提供数据备份和恢复功能。

**主要功能：**
- 创建备份
- 恢复备份
- 列出备份
- 删除备份

**使用示例：**
```python
from services.service_factory import ServiceFactory

backup_service = ServiceFactory.get_backup_service()

# 创建备份
backup_info = backup_service.create_backup("我的备份", "系统备份")

# 列出所有备份
backups = backup_service.list_backups()
```

### 6. 冲突检测服务 (ConflictDetectionService)
提供课程和课程表的冲突检测功能。

**主要功能：**
- 检测课程冲突
- 检测课程表冲突

**使用示例：**
```python
from services.service_factory import ServiceFactory

conflict_service = ServiceFactory.get_conflict_detection_service()

# 检测课程冲突
conflicts = conflict_service.detect_course_conflicts(course)
```

### 7. 提醒服务 (ReminderService)
提供自动提醒功能，支持课程开始前提醒和明日课程提醒。

**主要功能：**
- 启动提醒服务
- 停止提醒服务
- 添加提醒回调
- 移除提醒回调

**使用示例：**
```python
from services.service_factory import ServiceFactory

reminder_service = ServiceFactory.get_reminder_service()

# 启动提醒服务
reminder_service.start_reminder_service()

# 添加回调函数
def my_reminder_callback(reminder_info):
    print(f"提醒: {reminder_info}")

reminder_service.add_reminder_callback(my_reminder_callback)
```

### 8. 同步服务 (SyncService)
提供多设备数据同步功能。

**主要功能：**
- 同步数据到目录
- 从目录同步数据
- 获取同步状态

**使用示例：**
```python
from services.service_factory import ServiceFactory

sync_service = ServiceFactory.get_sync_service()

# 同步数据到目录
sync_service.sync_to_directory("./sync_data")

# 从目录同步数据
sync_service.sync_from_directory("./sync_data")
```

### 9. 配置服务 (ConfigService)
提供系统配置管理功能。

**主要功能：**
- 获取系统配置
- 更新系统配置
- 重置为默认配置
- 获取/设置配置值

**使用示例：**
```python
from services.service_factory import ServiceFactory

config_service = ServiceFactory.get_config_service()

# 获取系统配置
config = config_service.get_system_config()

# 更新系统配置
config_service.update_system_config({
    "theme": "dark",
    "language": "en-US"
})
```

## 跨平台兼容性

所有新服务都经过设计以确保在Linux、Windows和Mac OS系统上都能正常运行：

1. 使用Python标准库处理文件路径，确保路径分隔符兼容性
2. 使用统一的文件编码（UTF-8）处理文本文件
3. 使用标准库处理文件权限和系统调用

## 错误处理和日志记录

所有新服务都集成了统一的异常处理框架和详细的日志记录功能：

1. 使用自定义异常类处理特定错误
2. 详细的日志记录，包括DEBUG、INFO、WARNING、ERROR和CRITICAL级别
3. 错误恢复机制，确保服务的稳定运行
4. 友好的错误提示信息，便于用户理解问题

## 使用建议

1. 在使用需要密码保护的功能前，先设置系统密码
2. 定期备份重要数据
3. 使用统计数据来优化课程安排
4. 启用提醒服务以避免错过课程
5. 使用数据同步功能在多设备间同步数据

## 技术支持

如有任何问题或建议，请联系开发团队。